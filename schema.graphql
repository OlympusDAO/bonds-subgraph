type BondSnapshot @entity(immutable: true) {
  id: ID! # <contract address>/<contract id>/<block>
  contractAddress: Bytes!
  contractId: BigInt!
  date: String! # ISO 8601
  timestamp: BigInt! # Unix epoch
  block: BigInt!
  # Market data
  isLive: Boolean!
  price: BigDecimal! # OHM
  owner: Bytes!
  payoutToken: Bytes!
  quoteToken: Bytes!
  capacity: BigDecimal! # OHM
  totalDebt: BigDecimal! # OHM
  minPrice: BigDecimal! # OHM
  maxPayout: BigDecimal!
  sold: BigDecimal!
  purchased: BigDecimal!
  controlVariable: BigInt!
  previousControlVariable: BigInt!

  tuneIntervalSeconds: BigInt!
  lastTuneTimestamp: BigInt! # Unix epoch
  lastTuneDate: String!
  lastTuneSecondsAgo: BigInt!
  nextTuneInSeconds: BigInt!
  nextTuneDate: String!

  debtDecayIntervalSeconds: BigInt!
  lastDecayTimestamp: BigInt! # Unix epoch
  lastDecayDate: String!
  lastDecaySecondsAgo: BigInt!
  nextDecayInSeconds: BigInt!
  nextDecayDate: String!

  depositIntervalSeconds: BigInt!
  tuneAdjustmentDelaySeconds: BigInt!
  tuneIntervalCapacity: BigDecimal!
  tuneBelowCapacity: BigDecimal!
  lastTuneDebt: BigDecimal!
}

type TunedEvent @entity(immutable: true) {
  id: ID! # <contract address>/<contract id>/timestamp
  contractAddress: Bytes!
  contractId: BigInt!
  timestamp: BigInt!
  block: BigInt!
  previousControlVariable: BigInt!
  newControlVariable: BigInt!
}

type Market @entity {
  id: ID!
  bondContract: Bytes!
  payoutToken: Bytes!
  quoteToken: Bytes!
  capacity: BigDecimal!
  capacityInQuote: Boolean!
  totalDebt: BigDecimal!
  minPrice: BigDecimal!
  maxPayout: BigDecimal!
  createdBlock: BigInt!
  createdDate: String!
  createdTimestamp: BigInt!
  closedBlock: BigInt!
  closedDate: String!
  closedTimestamp: BigInt
}

type MarketCreatedEvent @entity(immutable: true) {
  id: ID!
  marketId: BigInt!
  date: String!
  timestamp: BigInt!
  block: BigInt!
  market: Market!
}

type MarketClosedEvent @entity(immutable: true) {
  id: ID!
  marketId: BigInt!
  date: String!
  timestamp: BigInt!
  block: BigInt!
  market: Market!
}
